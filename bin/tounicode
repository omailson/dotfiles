#!/bin/bash

comando() {
for i in $*; do
    iconv -t utf8 -f iso8859-1 "$i" --output "$i.converted" && rm "$i" && mv "$i.converted" "$i"
done
}

recursao() {
for a in *; do
    if [ -d "$a" ]; then
        cd "$a"
        recursao *
        cd ..
    else
        comando "$a"
    fi
done
}

if [ "$1" = '-r' ]; then
    recursao *
else
    comando "$*"
fi
